"use strict";const e=require("vue"),l=require("./useDefaults-q0yyNSBk.js"),a=require("./index-DiURjA3G.js"),o=require("./useSafeScrollLock-Xjl1NHrG.js"),t=require("./BButton.vue_vue_type_script_setup_true_lang-DHpIDYI_.js"),r=require("./BCloseButton.vue_vue_type_script_setup_true_lang-DZGcyqBT.js"),n=require("./useId-CVpYZavN.js"),s=require("./dom-CoD-aJvn.js"),d=require("./useColorVariantClasses-CE658Sm0.js"),i=require("./useModalManager-s_gKy0a-.js"),u=require("./useShowHide-Bb4cHgbQ.js"),c=require("./ConditionalTeleport.vue_vue_type_script_lang-DOGq8bM-.js"),f=require("./getElement-BPs-1fVW.js"),p=require("./src/composables/useModalController/index.umd.js"),v=["id","aria-labelledby","aria-describedby"],m=["id"],k="modal-fallback-focus",b=e.defineComponent({inheritAttrs:!1,__name:"BModal",props:e.mergeModels({focus:{type:[String,Boolean,Object,null],default:void 0},backdropFirst:{type:Boolean,default:!1},body:{default:void 0},bodyAttrs:{default:void 0},bodyBgVariant:{default:null},bodyClass:{default:null},bodyScrolling:{type:Boolean,default:!1},bodyTextVariant:{default:null},bodyVariant:{default:null},busy:{type:Boolean,default:!1},buttonSize:{default:"md"},cancelClass:{default:void 0},cancelDisabled:{type:Boolean,default:!1},cancelTitle:{default:"Cancel"},cancelVariant:{default:"secondary"},centered:{type:Boolean,default:!1},contentClass:{default:void 0},dialogClass:{default:void 0},footerBgVariant:{default:null},footerBorderVariant:{default:null},footerClass:{default:void 0},footerTextVariant:{default:null},footerVariant:{default:null},fullscreen:{type:[Boolean,String],default:!1},headerBgVariant:{default:null},headerBorderVariant:{default:null},headerClass:{default:void 0},headerCloseClass:{default:void 0},headerCloseLabel:{default:"Close"},headerCloseVariant:{default:"secondary"},headerTextVariant:{default:null},headerVariant:{default:null},noBackdrop:{type:Boolean,default:!1},noFooter:{type:Boolean,default:!1},noHeader:{type:Boolean,default:!1},noHeaderClose:{type:Boolean,default:!1},id:{default:void 0},modalClass:{default:void 0},noCloseOnBackdrop:{type:Boolean,default:!1},noCloseOnEsc:{type:Boolean,default:!1},noTrap:{type:Boolean,default:!1},noStacking:{type:Boolean},okClass:{default:void 0},okDisabled:{type:Boolean,default:!1},okOnly:{type:Boolean,default:!1},okTitle:{default:"OK"},okVariant:{default:"primary"},scrollable:{type:Boolean,default:!1},size:{default:"md"},title:{default:void 0},titleClass:{default:void 0},titleVisuallyHidden:{type:Boolean,default:!1},titleTag:{default:"h5"},teleportDisabled:{type:Boolean,default:!1},teleportTo:{default:"body"},initialAnimation:{type:Boolean,default:!1},noAnimation:{type:Boolean},noFade:{type:Boolean,default:!1},lazy:{type:Boolean,default:!1},unmountLazy:{type:Boolean,default:!1},show:{type:Boolean,default:!1},transProps:{default:void 0},visible:{type:Boolean,default:!1}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:e.mergeModels(["backdrop","close","esc","hide","hide-prevented","hidden","show","show-prevented","shown","toggle","toggle-prevented","cancel","ok"],["update:modelValue"]),setup(p,{expose:b,emit:y}){const B=p,g=l.useDefaults(B,"BModal"),C=y,h=e.useSlots(),V=n.useId((()=>g.id),"modal"),_=e.useModel(p,"modelValue"),S=e.useTemplateRef("_element"),T=e.useTemplateRef("_fallbackFocusElement"),x=e.useTemplateRef("_okButton"),w=e.useTemplateRef("_cancelButton"),z=e.useTemplateRef("_closeButton"),P=()=>g.focus&&"boolean"!=typeof g.focus?"ok"===g.focus?x:"close"===g.focus?z:"cancel"===g.focus?w:f.getElement(g.focus,S.value??void 0)??S.value:S;let E=null;const{showRef:N,renderRef:D,renderBackdropRef:M,hide:$,show:H,toggle:R,computedNoAnimation:j,transitionProps:q,backdropTransitionProps:F,isLeaving:A,isVisible:O,trapActive:L,contentShowing:I,backdropReady:Z,backdropVisible:K}=u.useShowHide(_,g,C,S,V,{transitionProps:{onAfterEnter:()=>{if(g.noTrap&&!1!==g.focus){E=document.activeElement,E===S.value&&(E=null);const e=a.unrefElement(P());if(!e)return;null==e||e.focus(),e.tagName&&"input"===e.tagName.toLowerCase()&&"function"==typeof e.select&&e.select()}},onAfterLeave:()=>{g.noTrap&&!1!==g.focus&&E&&(null==E||E.focus(),E=null)}}}),{needsFallback:W}=o.useActivatedFocusTrap({element:S,isActive:L,noTrap:()=>g.noTrap,fallbackFocus:{ref:T,classSelector:k},focus:()=>!1!==g.focus&&(a.unrefElement(P())??void 0)});a.onKeyStroke("Escape",(()=>{$("esc")}),{target:S}),o.useSafeScrollLock(N,(()=>g.bodyScrolling));const X=e.computed((()=>!s.isEmptySlot(h["header-close"]))),Y=e.computed((()=>[g.dialogClass,{"modal-fullscreen":!0===g.fullscreen,[`modal-fullscreen-${g.fullscreen}-down`]:"string"==typeof g.fullscreen,[`modal-${g.size}`]:"md"!==g.size,"modal-dialog-centered":g.centered,"modal-dialog-scrollable":g.scrollable}])),G=d.useColorVariantClasses((()=>({bgVariant:g.bodyBgVariant,textVariant:g.bodyTextVariant,variant:g.bodyVariant}))),J=e.computed((()=>[g.bodyClass,G.value])),Q=d.useColorVariantClasses((()=>({bgVariant:g.headerBgVariant,textVariant:g.headerTextVariant,variant:g.headerVariant,borderVariant:g.headerBorderVariant}))),U=e.computed((()=>[g.headerClass,Q.value])),ee=e.computed((()=>({variant:X.value?g.headerCloseVariant:void 0,class:g.headerCloseClass}))),le=d.useColorVariantClasses((()=>({bgVariant:g.footerBgVariant,textVariant:g.footerTextVariant,variant:g.footerVariant,borderVariant:g.footerBorderVariant}))),ae=e.computed((()=>[g.footerClass,le.value])),oe=e.computed((()=>[g.titleClass,{"visually-hidden":g.titleVisuallyHidden}])),te=e.computed((()=>g.cancelDisabled||g.busy)),re=e.computed((()=>g.okDisabled||g.busy)),{activePosition:ne,activeModalCount:se,stackWithoutSelf:de}=i.useModalManager(N,_.value),ie=e.computed((()=>({[`stack-position-${(null==ne?void 0:ne.value)??0}`]:!0,["stack-inverse-position-"+(((null==se?void 0:se.value)??1)-1-((null==ne?void 0:ne.value)??0))]:!0})));e.watch(de,((e,l)=>{e.length>l.length&&!0===N.value&&!0===g.noStacking&&$()}));const ue=e.ref(s.getModalZIndex(S.value??document.body));e.onMounted((()=>{e.watch(D,(l=>{l&&e.nextTick((()=>{S.value&&(ue.value=s.getModalZIndex(S.value))}))}),{immediate:!0})}));const ce=e.computed((()=>N.value||A.value?ue.value-(2*((null==se?void 0:se.value)??0)-2*((null==ne?void 0:ne.value)??0)):ue.value)),fe=e.computed((()=>({"z-index":ce.value,"--b-position":(null==ne?void 0:ne.value)??0,"--b-inverse-position":((null==se?void 0:se.value)??1)-1-((null==ne?void 0:ne.value)??0),"--b-count":(null==se?void 0:se.value)??0}))),pe=e.computed((()=>({"z-index":ce.value-1,"--b-position":(null==ne?void 0:ne.value)??0,"--b-inverse-position":((null==se?void 0:se.value)??1)-1-((null==ne?void 0:ne.value)??0),"--b-count":(null==se?void 0:se.value)??0}))),ve=e.computed((()=>({id:V.value,cancel:()=>{$("cancel")},close:()=>{$("close")},hide:$,show:H,toggle:R,ok:()=>{$("ok")},active:N.value,visible:N.value})));return b({hide:$,id:V,show:H,toggle:R,visible:N}),(l,a)=>(e.openBlock(),e.createBlock(c._sfc_main,{to:e.unref(g).teleportTo,disabled:e.unref(g).teleportDisabled},{default:e.withCtx((()=>[e.unref(D)||e.unref(I)?(e.openBlock(),e.createBlock(e.Transition,e.mergeProps({key:0},e.unref(q),{appear:_.value||e.unref(g).visible}),{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("div",e.mergeProps({id:e.unref(V),ref:"_element",class:["modal",[e.unref(g).modalClass,{fade:!e.unref(j),show:e.unref(O),...ie.value}]],role:"dialog","aria-labelledby":e.unref(g).noHeader?void 0:`${e.unref(V)}-label`,"aria-describedby":`${e.unref(V)}-body`,tabindex:"-1"},l.$attrs,{style:[fe.value,{display:"block"}],onMousedown:a[4]||(a[4]=e.withModifiers((l=>e.unref($)("backdrop")),["left","self"]))}),[e.createElementVNode("div",{class:e.normalizeClass(["modal-dialog",Y.value])},[e.unref(I)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["modal-content",e.unref(g).contentClass])},[e.unref(g).noHeader?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["modal-header",U.value])},[e.renderSlot(l.$slots,"header",e.normalizeProps(e.guardReactiveProps(ve.value)),(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(g).titleTag),{id:`${e.unref(V)}-label`,class:e.normalizeClass(["modal-title",oe.value])},{default:e.withCtx((()=>[e.renderSlot(l.$slots,"title",e.normalizeProps(e.guardReactiveProps(ve.value)),(()=>[e.createTextVNode(e.toDisplayString(e.unref(g).title),1)]))])),_:3},8,["id","class"])),e.unref(g).noHeaderClose?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[X.value?(e.openBlock(),e.createBlock(t._sfc_main,e.mergeProps({key:0},ee.value,{onClick:a[0]||(a[0]=l=>e.unref($)("close"))}),{default:e.withCtx((()=>[e.renderSlot(l.$slots,"header-close",e.normalizeProps(e.guardReactiveProps(ve.value)))])),_:3},16)):(e.openBlock(),e.createBlock(r._sfc_main,e.mergeProps({key:1,"aria-label":e.unref(g).headerCloseLabel},ee.value,{onClick:a[1]||(a[1]=l=>e.unref($)("close"))}),null,16,["aria-label"]))],64))]))],2)),e.createElementVNode("div",e.mergeProps({id:`${e.unref(V)}-body`,class:["modal-body",J.value]},e.unref(g).bodyAttrs),[e.renderSlot(l.$slots,"default",e.normalizeProps(e.guardReactiveProps(ve.value)),(()=>[e.createTextVNode(e.toDisplayString(e.unref(g).body),1)]))],16,m),e.unref(g).noFooter?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["modal-footer",ae.value])},[e.renderSlot(l.$slots,"footer",e.normalizeProps(e.guardReactiveProps(ve.value)),(()=>[e.renderSlot(l.$slots,"cancel",e.normalizeProps(e.guardReactiveProps(ve.value)),(()=>[e.unref(g).okOnly?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(t._sfc_main,{key:0,ref:"_cancelButton",disabled:te.value,size:e.unref(g).buttonSize,variant:e.unref(g).cancelVariant,class:e.normalizeClass(e.unref(g).cancelClass),onClick:a[2]||(a[2]=l=>e.unref($)("cancel"))},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(e.unref(g).cancelTitle),1)])),_:1},8,["disabled","size","variant","class"]))])),e.renderSlot(l.$slots,"ok",e.normalizeProps(e.guardReactiveProps(ve.value)),(()=>[e.createVNode(t._sfc_main,{ref:"_okButton",disabled:re.value,size:e.unref(g).buttonSize,variant:e.unref(g).okVariant,class:e.normalizeClass(e.unref(g).okClass),onClick:a[3]||(a[3]=l=>e.unref($)("ok"))},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(e.unref(g).okTitle),1)])),_:1},8,["disabled","size","variant","class"])]))]))],2))],2)):e.createCommentVNode("",!0)],2),e.unref(W)?(e.openBlock(),e.createElementBlock("div",{key:0,ref:"_fallbackFocusElement",class:e.normalizeClass(k),tabindex:"0",style:{width:"0",height:"0",overflow:"hidden"}},null,512)):e.createCommentVNode("",!0)],16,v),[[e.vShow,e.unref(N)&&(e.unref(Z)&&e.unref(g).backdropFirst||!e.unref(g).backdropFirst)]])])),_:3},16,["appear"])):e.createCommentVNode("",!0),e.unref(g).noBackdrop?e.createCommentVNode("",!0):e.renderSlot(l.$slots,"backdrop",e.normalizeProps(e.mergeProps({key:1},ve.value)),(()=>[e.unref(M)?(e.openBlock(),e.createBlock(e.Transition,e.normalizeProps(e.mergeProps({key:0},e.unref(F))),{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("div",{class:e.normalizeClass(["modal-backdrop",{fade:!e.unref(j),show:e.unref(K)||e.unref(j),...ie.value}]),style:e.normalizeStyle(pe.value),onClick:a[5]||(a[5]=l=>e.unref($)("backdrop"))},null,6),[[e.vShow,e.unref(N)||e.unref(A)&&e.unref(g).backdropFirst&&!e.unref(j)]])])),_:1},16)):e.createCommentVNode("",!0)]))])),_:3},8,["to","disabled"]))}}),y=e.defineComponent({inheritAttrs:!1,__name:"BModalOrchestrator",props:{teleportDisabled:{type:Boolean,default:!1},teleportTo:{default:"body"}},setup(a,{expose:o}){const t=a,r=l.useDefaults(t,"BModalOrchestrator"),n=p.useModalController();return n._isOrchestratorInstalled.value=!0,o({...n}),(l,a)=>(e.openBlock(),e.createBlock(c._sfc_main,{to:e.unref(r).teleportTo,disabled:e.unref(r).teleportDisabled},{default:e.withCtx((()=>{var a;return[e.createElementVNode("div",e.mergeProps({id:"__BVID__modal-container"},l.$attrs),[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null==(a=e.unref(n).modals)?void 0:a.value,(([l,{component:a,promise:o,options:t,slots:r,...n}])=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(a??b),e.mergeProps({key:l,ref_for:!0,ref:e=>o.value.ref=e},n,{"initial-animation":"","teleport-disabled":!0,onHide:e=>{var l,a;e.ok="ok"===e.trigger||"cancel"!==e.trigger&&null,null==(l=n.onHide)||l.call(n,e),e.defaultPrevented||(null==(a=o.stop)||a.call(o),(null==t?void 0:t.resolveOnHide)&&o.resolve(t.returnBoolean?e.ok:e))},onHidden:e=>{var l,a,r;e.ok="ok"===e.trigger||"cancel"!==e.trigger&&null,null==(l=n.onHidden)||l.call(n,e),e.defaultPrevented||((null==t?void 0:t.resolveOnHide)||o.resolve(t.returnBoolean?e.ok:e),(null==t?void 0:t.keep)||null==(r=(a=o.value).destroy)||r.call(a))}}),e.createSlots({_:2},[e.renderList(r,((l,a)=>({name:a,fn:e.withCtx((a=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l),e.mergeProps({ref_for:!0},a),null,16))]))})))]),1040,["onHide","onHidden"])))),128))],16)]})),_:1},8,["to","disabled"]))}});exports._sfc_main=b,exports._sfc_main$1=y;
//# sourceMappingURL=BModalOrchestrator.vue_vue_type_script_setup_true_lang-BxJSL7fC.js.map
