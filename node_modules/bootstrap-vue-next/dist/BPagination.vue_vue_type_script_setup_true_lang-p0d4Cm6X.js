"use strict";const e=require("vue"),a=require("./classes-BPvGsmbC.js"),l=require("./useAlignment-BTUJZ_9x.js"),t=require("./useDefaults-q0yyNSBk.js"),s=require("./constants-B1zBgSOo.js"),o=require("./event-UQ02889E.js"),u=require("./dom-CoD-aJvn.js"),i=require("./index-BjjsoN-a.js"),n=["aria-disabled","aria-label"],d=["displayIndex"],r=e.defineComponent({__name:"BPagination",props:e.mergeModels({align:{default:"start"},ariaControls:{default:void 0},ariaLabel:{default:"Pagination"},disabled:{type:Boolean,default:!1},ellipsisClass:{default:void 0},ellipsisText:{default:"…"},firstClass:{default:void 0},firstNumber:{type:Boolean,default:!1},firstText:{default:"«"},noEllipsis:{type:Boolean,default:!1},noGotoEndButtons:{type:Boolean,default:!1},labelFirstPage:{default:"Go to first page"},labelLastPage:{default:"Go to last page"},labelNextPage:{default:"Go to next page"},labelPage:{default:"Go to page"},labelPrevPage:{default:"Go to previous page"},lastClass:{default:void 0},lastNumber:{type:Boolean,default:!1},lastText:{default:"»"},limit:{default:5},nextClass:{default:void 0},nextText:{default:"›"},pageClass:{default:void 0},perPage:{default:20},pills:{type:Boolean,default:!1},prevClass:{default:void 0},prevText:{default:"‹"},size:{default:void 0},totalRows:{default:0}},{modelValue:{default:1},modelModifiers:{}}),emits:e.mergeModels(["page-click"],["update:modelValue"]),setup(r,{emit:v}){const c=-2,p=-3,m=r,f=t.useDefaults(m,"BPagination"),g=v,b=e.useModel(r,"modelValue"),x=e.useTemplateRef("_pageElements"),h=i.useToNumber((()=>f.limit),{nanToZero:!0,method:"parseInt"}),T=i.useToNumber((()=>f.perPage),{nanToZero:!0,method:"parseInt"}),N=i.useToNumber((()=>f.totalRows),{nanToZero:!0,method:"parseInt"}),k=i.useToNumber(b,{nanToZero:!0,method:"parseInt"}),C=e.computed((()=>Math.max(T.value||20,1))),E=e.computed((()=>Math.max(N.value||0,0))),P=e.computed((()=>Math.ceil(E.value/C.value))),B=e.computed((()=>"fill"===f.align)),y=e.computed((()=>"fill"===f.align?"start":f.align)),V=l.useAlignment(y),_=e=>e===J.value,w=e=>f.disabled||_(e)||J.value<1||e<1||e>P.value,I=e.computed((()=>w(1))),A=e.computed((()=>w(J.value-1))),M=e.computed((()=>w(P.value))),D=e.computed((()=>w(J.value+1))),O=({page:e,classVal:a,disabled:l,slotName:t,textValue:s,tabIndex:o,label:u,position:i,isActive:n,hidden:d,isSmHidden:r})=>({li:{class:["page-item",{active:n,disabled:l,"bv-d-sm-down-none":r,"flex-fill":B.value,"d-flex":B.value&&!l},a],role:"presentation","aria-hidden":d},button:{is:l?"span":"button",class:["page-link","text-center",{"flex-grow-1":!l&&B.value}],"aria-label":u,"aria-controls":f.ariaControls||void 0,"aria-disabled":!!l||void 0,"aria-posinset":i,"aria-setsize":i?P.value:void 0,role:"menuitem",type:l?void 0:"button",tabindex:l?void 0:o},text:{name:t,active:n,value:s??e,page:e,disabled:l,index:e-1,content:s?void 0:e},clickHandler:a=>F(a,e)}),G=({page:e,classVal:a,disabled:l,slotName:t,textValue:s,label:o})=>O({page:e,classVal:a,disabled:l,slotName:t,textValue:s,label:o,tabIndex:"-1"}),L=(e,a)=>{return O({page:e,disabled:f.disabled,classVal:f.pageClass,slotName:"page",label:f.labelPage?`${f.labelPage} ${e}`:void 0,tabIndex:(l=e,(f.disabled?null:_(l)?"0":"-1")??void 0),position:e,isActive:_(e),isSmHidden:a});var l},S=e.computed((()=>G({page:1,disabled:I.value,classVal:f.firstClass,slotName:"first-text",textValue:f.firstText,label:f.labelFirstPage}))),q=e.computed((()=>G({page:Math.max(J.value-1,1),disabled:A.value,classVal:f.prevClass,slotName:"prev-text",textValue:f.prevText,label:f.labelPrevPage}))),z=e.computed((()=>G({page:Math.min(J.value+1,P.value),disabled:D.value,classVal:f.nextClass,slotName:"next-text",textValue:f.nextText,label:f.labelNextPage}))),R=e.computed((()=>G({page:P.value,disabled:M.value,classVal:f.lastClass,slotName:"last-text",textValue:f.lastText,label:f.labelLastPage}))),j=e.computed((()=>({li:{class:["page-item","disabled","text-center","bv-d-sm-down-none",B.value?"flex-fill":"",f.ellipsisClass],role:"separator"},span:{class:["page-link"]}}))),$=e.computed((()=>[V.value,{[`pagination-${f.size}`]:void 0!==f.size,"b-pagination-pills":f.pills}])),H=e.computed((()=>({pageSize:C.value,totalRows:N.value,numberOfPages:P.value}))),F=(l,t)=>{if(t===J.value)return;const s=new a.BvEvent("page-click",{cancelable:!0,target:l.target});g("page-click",s,t),s.defaultPrevented||(b.value=t,e.nextTick((()=>{1===t?K():t===H.value.numberOfPages&&W()})))},Z=e=>{const a=!(!e||e.nodeType!==Node.ELEMENT_NODE),l=a?e.hasAttribute("disabled"):null,t=!(!a||!e.classList)&&e.classList.contains("disabled");return!a||e.disabled||l||t},U=()=>{var e,a,l,t;return null==(t=null==(l=null==(a=null==(e=[...x.value??[]])?void 0:e.sort(((e,a)=>parseInt(e.getAttribute("displayIndex")||"0")-parseInt(a.getAttribute("displayIndex")||"0"))))?void 0:a.map((e=>e.children[0])))?void 0:l.filter((e=>{if("none"===e.getAttribute("display")||"BUTTON"!==e.tagName.toUpperCase())return!1;const a=e.getBoundingClientRect();return!!(a&&a.height>0&&a.width>0)})))?void 0:t.map((e=>e))},K=()=>{e.nextTick((()=>{const e=U().find((e=>!Z(e)));null==e||e.focus()}))},W=()=>{e.nextTick((()=>{const e=U().reverse().find((e=>!Z(e)));null==e||e.focus()}))},X=a=>{const{code:l,shiftKey:t}=a;l===s.CODE_LEFT||l===s.CODE_UP?(o.stopEvent(a),t?K():e.nextTick((()=>{var e;const a=U(),l=a.indexOf(u.getActiveElement());l>0&&!Z(a[l-1])&&(null==(e=a[l-1])||e.focus())}))):l!==s.CODE_RIGHT&&l!==s.CODE_DOWN||(o.stopEvent(a),t?W():e.nextTick((()=>{var e;const a=U(),l=a.indexOf(u.getActiveElement());l<a.length-1&&!Z(a[l+1])&&(null==(e=a[l+1])||e.focus())})))},J=e.computed((()=>{const e=k.value||1;return e>P.value?P.value:e<1?1:e}));e.watch(H,((e,a)=>{a.pageSize!==e.pageSize&&a.totalRows===e.totalRows&&(b.value=1)}));const Q=e.computed((()=>f.noGotoEndButtons&&!f.firstNumber?1:0)),Y=e.computed((()=>f.noGotoEndButtons&&!f.lastNumber?1:0)),ee=e.computed((()=>Q.value?0:1)),ae=e.computed((()=>Y.value?0:1)),le=e.computed((()=>f.firstNumber?1:0)),te=e.computed((()=>f.lastNumber?1:0)),se=e.computed((()=>Math.floor(h.value/2))),oe=e.computed((()=>{const{value:e}=J,a=ue.value.map((e=>{switch(e){case-1:return{id:e,...S.value};case c:return{id:e,...q.value};case p:return{id:e,...z.value};case-4:return{id:e,...R.value};case-5:case-6:return{id:e,...j.value};default:return{id:e,...L(e)}}}));if(P.value>3){if(e>P.value-se.value-te.value){const e=2+ee.value;a[e]={id:a[e].id,...L(a[e].id,!0)}}if(e<=se.value+le.value){const e=a.length-(3+ae.value);a[e]={id:a[e].id,...L(a[e].id,!0)}}}return a})),ue=e.computed((()=>{const e=P.value,{value:a}=J,l=h.value,t=f.noEllipsis||l<=3;if(e<l+le.value+te.value)return[le.value||Q.value?null:-1,c,...Array.from({length:e},((e,a)=>a+1)),p,te.value||Y.value?null:-4].filter((e=>null!==e));const s=Array.from({length:l+4-(Q.value+Y.value)});if(Q.value?s[0]=c:le.value?(s[0]=c,s[1]=1):(s[0]=-1,s[1]=c),Y.value?s[s.length-1]=p:te.value?(s[s.length-1]=p,s[s.length-2]=e):(s[s.length-1]=-4,s[s.length-2]=p),a<=se.value+le.value){for(let e=1;e<=l;e++)s[e+1-Q.value]=e+le.value;t||(s[s.length-(2+ae.value)]=-6)}if(a>e-se.value-te.value){const a=e-(l-1)-te.value;for(let e=0;e<l;e++)s[e+2-Q.value]=a+e;t||(s[1+ee.value]=-5)}if(!s[2]){const e=a-Math.floor(l/2);for(let a=0;a<l;a++)s[a+2-Q.value]=e+a;t||(s[1+ee.value]=-5,s[s.length-(2+ae.value)]=-6)}return s.filter((e=>null!==e))}));return(a,l)=>(e.openBlock(),e.createElementBlock("ul",{class:e.normalizeClass(["pagination",$.value]),role:"menubar","aria-disabled":e.unref(f).disabled,"aria-label":e.unref(f).ariaLabel||void 0,onKeydown:X},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(oe.value,((l,t)=>(e.openBlock(),e.createElementBlock("li",e.mergeProps({key:`page-${l.id}`,ref_for:!0},l.li,{ref_for:!0,ref:"_pageElements",displayIndex:t}),[-5===l.id||-6===l.id?(e.openBlock(),e.createElementBlock("span",e.mergeProps({key:0,ref_for:!0},j.value.span),[e.renderSlot(a.$slots,"ellipsis-text",{},(()=>[e.createTextVNode(e.toDisplayString(e.unref(f).ellipsisText||"..."),1)]))],16)):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(l.button.is),e.mergeProps({key:1,ref_for:!0},l.button,{onClick:l.clickHandler}),{default:e.withCtx((()=>[e.renderSlot(a.$slots,l.text.name,{disabled:l.text.disabled,page:l.text.page,index:l.text.index,active:l.text.active,content:l.text.value},(()=>[e.createTextVNode(e.toDisplayString(l.text.value),1)]))])),_:2},1040,["onClick"]))],16,d)))),128))],42,n))}});exports._sfc_main=r;
//# sourceMappingURL=BPagination.vue_vue_type_script_setup_true_lang-p0d4Cm6X.js.map
